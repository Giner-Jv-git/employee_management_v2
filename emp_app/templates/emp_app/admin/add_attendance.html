{% extends 'emp_app/base.html' %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-cyan-100 via-blue-50 to-teal-100 relative overflow-hidden">
    <!-- Beach Wave Background -->
    <div class="absolute inset-0">
        <svg class="absolute bottom-0 w-full h-32 text-cyan-200 opacity-30" preserveAspectRatio="none" viewBox="0 0 1200 120" fill="currentColor">
            <path d="M0,0 C300,40 600,80 900,60 C1050,50 1150,30 1200,20 L1200,120 L0,120 Z"/>
        </svg>
        <svg class="absolute top-0 w-full h-32 text-teal-200 opacity-20" preserveAspectRatio="none" viewBox="0 0 1200 120" fill="currentColor">
            <path d="M0,120 C300,80 600,40 900,60 C1050,70 1150,90 1200,100 L1200,0 L0,0 Z"/>
        </svg>
    </div>

    <div class="container mx-auto px-4 py-8 relative z-10">
        <!-- Header -->
        <div class="text-center mb-10">
            <!-- Breadcrumb -->
            <nav class="text-sm text-teal-600 mb-6 flex justify-center items-center">
                <a href="{% url 'attendance_management' %}" class="hover:text-cyan-600 transition-colors duration-200 font-medium">
                    ğŸ–ï¸ Attendance Paradise
                </a>
                <span class="mx-3 text-teal-400">â€º</span>
                <span class="text-teal-800 font-bold">ğŸ“ Add Record</span>
            </nav>
            
            <div class="flex justify-center items-center mb-4">
                <div class="bg-gradient-to-r from-cyan-400 to-teal-500 rounded-full p-4 shadow-lg">
                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                </div>
            </div>
            <h1 class="text-4xl font-bold bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent mb-3">
                â• Add Beach Record
            </h1>
            <p class="text-teal-700 text-lg">Create a manual attendance record for {{ employee.name }}</p>
        </div>

        <!-- Employee Info Card -->
        <div class="bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl border border-cyan-200 p-8 mb-8 max-w-2xl mx-auto">
            <div class="flex items-center">
                {% if employee.profile_picture %}
                    <img class="h-20 w-20 rounded-full object-cover mr-6 border-4 border-cyan-200 shadow-lg" src="{{ employee.profile_picture.url }}" alt="{{ employee.name }}">
                {% else %}
                    <div class="h-20 w-20 rounded-full bg-gradient-to-r from-cyan-400 to-teal-500 flex items-center justify-center text-white font-bold text-2xl mr-6 shadow-lg">
                        {{ employee.name|first }}
                    </div>
                {% endif %}
                <div>
                    <h2 class="text-2xl font-bold text-teal-800 mb-1">ğŸ„â€â™‚ï¸ {{ employee.name }}</h2>
                    <p class="text-teal-600 text-lg mb-1">{{ employee.get_position_display }}</p>
                    <p class="text-sm text-teal-500 bg-cyan-50 px-3 py-1 rounded-full inline-block">
                        ID: {{ employee.employee_id }}
                    </p>
                </div>
            </div>
        </div>

        <!-- Form -->
        <div class="bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl border border-cyan-200 p-8 max-w-2xl mx-auto">
            <form method="post" class="space-y-8">
                {% csrf_token %}
                
                <!-- Date -->
                <div class="transform transition-all duration-200 hover:scale-105">
                    <label for="date" class="block text-sm font-bold text-teal-800 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-cyan-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                        </svg>
                        ğŸ“… Date <span class="text-red-500">*</span>
                    </label>
                    <input type="date" 
                           id="date" 
                           name="date" 
                           required
                           max="{{ today|date:'Y-m-d' }}"
                           class="w-full px-4 py-4 border-2 border-cyan-200 rounded-2xl focus:outline-none focus:ring-4 focus:ring-cyan-300 focus:border-cyan-500 bg-white/80 backdrop-blur-sm text-teal-800 font-medium shadow-lg">
                </div>

                <!-- Status -->
                <div class="transform transition-all duration-200 hover:scale-105">
                    <label for="status" class="block text-sm font-bold text-teal-800 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-cyan-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        ğŸ–ï¸ Beach Status <span class="text-red-500">*</span>
                    </label>
                    <select id="status" 
                            name="status" 
                            required
                            class="w-full px-4 py-4 border-2 border-cyan-200 rounded-2xl focus:outline-none focus:ring-4 focus:ring-cyan-300 focus:border-cyan-500 bg-white/80 backdrop-blur-sm text-teal-800 font-medium shadow-lg">
                        <option value="">Select Beach Status</option>
                        <option value="present">ğŸŒ´ Present (On the Beach)</option>
                        <option value="late">â° Late (Arrived After Wave)</option>
                        <option value="absent">ğŸ–ï¸ Absent (Away from Shore)</option>
                    </select>
                </div>

                <!-- Time In -->
                <div class="transform transition-all duration-200 hover:scale-105">
                    <label for="time_in" class="block text-sm font-bold text-teal-800 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-cyan-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path>
                        </svg>
                        ğŸŒ… Arrival Time <span class="text-red-500">*</span>
                    </label>
                    <input type="time" 
                           id="time_in" 
                           name="time_in" 
                           required
                           class="w-full px-4 py-4 border-2 border-cyan-200 rounded-2xl focus:outline-none focus:ring-4 focus:ring-cyan-300 focus:border-cyan-500 bg-white/80 backdrop-blur-sm text-teal-800 font-medium shadow-lg">
                </div>

                <!-- Time Out -->
                <div class="transform transition-all duration-200 hover:scale-105">
                    <label for="time_out" class="block text-sm font-bold text-teal-800 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-cyan-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                        </svg>
                        ğŸŒ‡ Departure Time <span class="text-teal-500">(Optional)</span>
                    </label>
                    <input type="time" 
                           id="time_out" 
                           name="time_out"
                           class="w-full px-4 py-4 border-2 border-cyan-200 rounded-2xl focus:outline-none focus:ring-4 focus:ring-cyan-300 focus:border-cyan-500 bg-white/80 backdrop-blur-sm text-teal-800 font-medium shadow-lg">
                    <p class="text-sm text-teal-600 mt-2 bg-cyan-50 px-3 py-2 rounded-xl">
                        ğŸ’¡ Leave empty if the employee is still enjoying the beach (working)
                    </p>
                </div>

                <!-- Action Buttons -->
                <div class="flex items-center gap-6 pt-8 border-t-2 border-cyan-200">
                    <button type="submit" 
                            class="flex-1 bg-gradient-to-r from-cyan-500 to-teal-500 hover:from-cyan-600 hover:to-teal-600 text-white font-bold py-4 px-8 rounded-2xl transition-all duration-200 flex items-center justify-center shadow-xl transform hover:scale-105">
                        <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                        âœ… Add Beach Record
                    </button>
                    
                    <a href="{% url 'attendance_management' %}" 
                       class="flex-1 bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-bold py-4 px-8 rounded-2xl transition-all duration-200 flex items-center justify-center shadow-xl transform hover:scale-105">
                        <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                        ğŸš« Cancel
                    </a>
                </div>
            </form>
        </div>

        <!-- Helper Info Card -->
        <div class="bg-white/80 backdrop-blur-sm rounded-3xl shadow-lg border border-cyan-200 p-6 max-w-2xl mx-auto mt-8">
            <h3 class="text-lg font-bold text-teal-800 mb-3 flex items-center">
                <svg class="w-5 h-5 mr-2 text-cyan-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                ğŸ–ï¸ Beach Guidelines
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                <div class="bg-emerald-50 p-4 rounded-xl">
                    <div class="font-bold text-emerald-800 mb-1">ğŸŒ´ Present</div>
                    <div class="text-emerald-700">Arrived on time and ready for beach activities</div>
                </div>
                <div class="bg-yellow-50 p-4 rounded-xl">
                    <div class="font-bold text-yellow-800 mb-1">â° Late</div>
                    <div class="text-yellow-700">Arrived after the morning wave (after 9:15 AM)</div>
                </div>
                <div class="bg-red-50 p-4 rounded-xl">
                    <div class="font-bold text-red-800 mb-1">ğŸ–ï¸ Absent</div>
                    <div class="text-red-700">Completely away from the beach today</div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Set default date to today
document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('date').value = new Date().toISOString().split('T')[0];
});

// Time validation with beach theme
document.getElementById('time_out').addEventListener('change', function() {
    const timeIn = document.getElementById('time_in').value;
    const timeOut = this.value;
    
    if (timeIn && timeOut && timeOut <= timeIn) {
        alert('ğŸŒŠ Beach departure time must be after arrival time!');
        this.value = '';
    }
});

// Status-based field visibility with beach theme
document.getElementById('status').addEventListener('change', function() {
    const timeInField = document.getElementById('time_in');
    const timeOutField = document.getElementById('time_out');
    const timeInLabel = timeInField.previousElementSibling;
    
    if (this.value === 'absent') {
        timeInField.required = false;
        timeInField.disabled = true;
        timeInField.value = '';
        timeOutField.disabled = true;
        timeOutField.value = '';
        timeInField.classList.add('opacity-50');
        timeOutField.classList.add('opacity-50');
        
        // Add beach-themed message
        if (!document.getElementById('absent-message')) {
            const message = document.createElement('div');
            message.id = 'absent-message';
            message.className = 'bg-red-50 border border-red-200 rounded-xl p-4 mt-4';
            message.innerHTML = '<div class="text-red-800 font-medium">ğŸ–ï¸ Since this person is away from the beach, time fields are not needed.</div>';
            timeOutField.parentNode.appendChild(message);
        }
    } else {
        timeInField.required = true;
        timeInField.disabled = false;
        timeOutField.disabled = false;
        timeInField.classList.remove('opacity-50');
        timeOutField.classList.remove('opacity-50');
        
        // Remove beach-themed message
        const message = document.getElementById('absent-message');
        if (message) {
            message.remove();
        }
    }
});

// Add floating animation to form elements
document.querySelectorAll('input, select').forEach(element => {
    element.addEventListener('focus', function() {
        this.parentNode.style.transform = 'translateY(-2px)';
        this.parentNode.style.boxShadow = '0 10px 25px rgba(0, 0, 0, 0.1)';
    });
    
    element.addEventListener('blur', function() {
        this.parentNode.style.transform = 'translateY(0)';
        this.parentNode.style.boxShadow = 'none';
    });
});
</script>
{% endblock %}